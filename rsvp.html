 <script>
  const RSVP_URL = "https://script.google.com/macros/s/XXXXX/exec"; // your Web App URL ending with /exec

  const form = document.getElementById('rsvpform');
  const msg  = document.getElementById('msg');
  const btn  = document.getElementById('submitBtn');

  const say = (t) => { msg.textContent = t || ''; };

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    say('');
    btn.disabled = true;

    try {
      // Send as URL-encoded form (no custom headers)
      const body = new URLSearchParams(new FormData(form));
      body.set('type','rsvp'); // so backend knows this is a form

      const res  = await fetch(RSVP_URL, { method: 'POST', body });
      const text = await res.text();
      let json; try { json = JSON.parse(text); } catch { json = {}; }

      if (json.ok) {
        window.location.href = 'confirm.html';
      } else {
        say('Submission error. Please try again.');
        console.log('Server response:', text);
      }
    } catch (err) {
      say('Network error. Please try again.');
      console.error(err);
    } finally {
      btn.disabled = false;
    }
  });
</script>
